Bootstrap: docker
From: ubuntu:22.04

%files
pscs_api-latest-py3-none-any.whl /pscs_api-latest-py3-none-any.whl
pscs_scanpy-latest-py3-none-any.whl /pscs_scanpy-latest-py3-none-any.whl

run_pscs_pipeline.py /run_pscs_pipeline.py

%post
su - root

apt-get update -qq
apt-get install -y -q --no-install-recommends \
    apt-utils \
    bzip2 \
    ca-certificates \
    curl \
    locales \
    unzip \
    git

apt-get install -y -q --no-install-recommends build-essential
apt-get install -y -q --no-install-recommends python3-setuptools
apt-get install -y python3.11 python3.11-dev python3-pip
apt-get install -y -q --no-install-recommends sudo wget

python3.11 -m pip install --upgrade pip
python3.11 -m pip install /pscs_api-latest-py3-none-any.whl
python3.11 -m pip install /pscs_scanpy-latest-py3-none-any.whl

apt-get clean
rm -rf /var/lib/apt/lists/*

%runscript
python3.11 /run_pscs_pipeline.py
