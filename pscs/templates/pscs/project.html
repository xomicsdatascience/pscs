{% extends 'base.html' %}

{% block header %}
<h1><center>{{ project_name }}</center></h1>
{% endblock %}

{% block content %}
<!--Data summary-->
<h2>Data Summary</h2>
<a class="action" href="{{ url_for('pscs.upload') }}">Upload Data</a>

<!--Analysis-->
<script>
  function color(id, color = 'rgba(255,255,255,0.2)'){
    elem = document.getElementById(id);
    elem.style.backgroundColor = color;
  }
</script>
<table>
  <tr>
    <th>file_path</th>
    <th>data_type</th>
    <th>date_uploaded</th>
  </tr>
  {% for data_row in project_data_summary %}
  <tr onmouseover="color('{{loop.index0}}', 'rgba(200,200,200,0.5)')" onmouseleave="color('{{loop.index0}}')" id="{{loop.index0}}">
    <td>{{data_row['file_path']}}</td>
    <td>{{data_row['data_type']}}</td>
    <td>{{data_row['data_uploaded_time']}}</td>
    <td><button onclick="startDeletion('{{data_row['id_data']}}', '{{data_row['file_path']}}' )">Delete</button></td>
  </tr>
  {% endfor %}
</table>


<h2>Analyses</h2>
<script src="/static/js/projects.js"></script>

<!-- Create dropdown of analyses -->
<!--<select name="analysis" id="analysis">-->
<script>
  function parseAndCreateTable(sel){
    analysis_nodes = {{analysis_nodes | tojson}}
    createTable({{files | tojson}}, analysis_nodes[sel.value]);
  }
</script>
<select name="analysis" id="analysis" autocomplete="off" onchange="parseAndCreateTable(this);">
  <option value="def" selected disabled>Select analysis pipeline...</option>
<!--    Go through each available analysis -->
  {% for an in analyses %}
<!--    <option value="{{an}}" onclick='createTable({{files | tojson}}, {{analysis_nodes[an] | tojson}} );'>{{analyses[an]}}</option>-->
    <option value="{{an}}">{{analyses[an]}}</option>
  {% endfor %}
</select>

<button onclick="executePipeline();">Run</button>
{% endblock %}